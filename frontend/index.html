<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Climate GIS Dashboard</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script> <!-- Added D3.js library -->

  <link rel="stylesheet" href="./style.css" />
  <script defer src="./map.js"></script>
</head>
<body>
  <div id="sidebar">
    <h2>Layers</h2>
    <div class="layer-controls">
      <div><input type="checkbox" id="chk-chko"><label for="chk-chko">CHKO</label></div>
      <div><input type="checkbox" id="chk-orp"><label for="chk-orp">ORP</label></div>
      <div><input type="checkbox" id="chk-climate_master_geom"><label for="chk-climate_master_geom">Klima</label></div>
    </div>

    <h2>Climate Data</h2>
    <div class="climate-controls">
      <label for="indicator-select">Indicator:</label>
      <select id="indicator-select">
        <option value="tavg_m">TAVG (monthly)</option>
        <option value="sra_m">SRA (monthly)</option>
        <option value="rh_m">RH (monthly)</option>
        <option value="wv_m">WV (monthly)</option>
        <option value="pet">PET</option>
        <option value="demartonne">De Martonne</option>
        <option value="heatindex">Heat Index</option>
      </select>

      <label for="year-select">Year:</label>
      <select id="year-select">
        <!-- Years will be dynamically populated by JS if needed, for now a placeholder -->
        <option value="2020">2020</option>
        <option value="2021">2021</option>
        <option value="2022">2022</option>
      </select>

      <label for="month-select">Month:</label>
      <select id="month-select">
        <option value="annual">Annual Average</option>
        <option value="1">January</option>
        <option value="2">February</option>
        <option value="3">March</option>
        <option value="4">April</option>
        <option value="5">May</option>
        <option value="6">June</option>
        <option value="7">July</option>
        <option value="8">August</option>
        <option value="9">September</option>
        <option value="10">October</option>
        <option value="11">November</option>
        <option value="12">December</option>
      </select>

      <button id="apply-filters">Apply</button>
    </div>
  </div>

  <div id="map"></div>

  <div id="legend" class="leaflet-control"></div>

  <div id="popup-container" style="display: none;">
    <div class="popup-content">
      <button class="close-popup" onclick="document.getElementById('popup-container').style.display='none';">&times;</button>
      <h3>Polygon Data</h3>
      <div id="popup-properties"></div>
      <h4>Climate Values:</h4>
      <table id="popup-climate-table"></table>
      <h4>Annual Trend:</h4>
      <canvas id="climate-chart"></canvas>
    </div>
  </div>
</body>
</html>
